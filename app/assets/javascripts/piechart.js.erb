/**
 * Displays the weighted tags in a pie chart
 *
 * @constructor
 */
function Piechart () {

  this.colors = [ 
    "#7e3838", 
    "#7a387e",
    "#4d387e", 
    "#38507e", 
    "#386a7e", 
    "#387e6a", 
    "#387e45",
    "#587e38", 
    "#7c7e38", 
    "#7e6538" 
  ];
  var pie = null;


  /**
   * Called when just the values of existing tags changes
   * (no animation)
   */
  this.updateVals = function() {

  };

  /**
   * Called whenever a tag is added or removed from the list
   * (full animation)
   */
  this.updateTagList = function() {
    
    // if there are no tags
    if (tagger.tags.length === 0) {
      // draw an empty circle
      return;
    }


    var data = [];
    
    for (var i=0 ; i < tagger.tags.length ; i++ ) {
      data.push({
        label: tagger.tags[i].name,
        value: tagger.tags[i].weight,
        color: this.colors[i]
      });
    }

    if (pie) {
      pie.updateProp("data.content", data);
    } else {
      pie = new d3pie("#pie-chart", {
        header: { // kill
          "title": {
            "text": "Weighted Tags",
            "color": "#dfdfdf",
            "fontSize": 24,
            "font": "helvetica"
          },
          "subtitle": { // kill
            "text": "The full, weighted list of tags to search for",
            "color": "#999999",
            "fontSize": 12,
            "font": "open sans"
          },
          "titleSubtitlePadding": 9
        },
        "footer": {
          "color": "#999999",
          "fontSize": 10,
          "font": "open sans",
          "location": "bottom-left"
        },
        "size": {
          "canvasWidth": 590,
          "pieInnerRadius": "66%",
          "pieOuterRadius": "90%"
        },
        data: {
          "sortOrder": "value-desc",
          content: data,
        },
        "labels": {
          "outer": {
            "pieDistance": 24
          },
          "inner": {
            "hideWhenLessThanPercentage": 3
          },
          "mainLabel": {
            "color": "#e6e6e6",
            "fontSize": 11
          },
          "percentage": {
            "color": "#d2d2d2",
            "decimalPlaces": 0
          },
          "value": {
            "color": "#797979",
            "fontSize": 11
          },
          "lines": {
            "enabled": true,
            "color": "#ffffff"
          }
        },
        "effects": {
          "pullOutSegmentOnClick": {
            "effect": "linear",
            "speed": 400,
            "size": 8
          }
        },
        "misc": {
          "colors": {
            "segmentStroke": "#747474"
          },
          "gradient": {
            "enabled": true,
            "percentage": 89
          }
        }
      });

    }     
    

  } // end updateTagList
  this.updateTagList();
} // end Piechart
